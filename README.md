# CNN神經網路的學習筆記

![模型架構圖](https://219.69.20.132/static/cnn_exercises.png)

透過自訂模型處理下列案例，進行訓練、指標評估、預測結果視覺化：
> 將著重在模型的輸入輸出與資料格式的對應關係（而非特徵萃取器本身的強度）

1. **天氣陰晴二分類**：設計輸出層有單一個神經元(有別於輸出層=類別樹目，如兩分類之間具變化關聯，可用同一單個神經元)，並使用經過sigmoid處理限縮數值介於[0,1]，如預測結果偏向陰天輸出愈接近0、偏向晴天則輸出機率趨於1。評估時透過Precision/Recall，以及綜合考量Precision/Recall的F1 score。
2. **貓臉特徵點座標迴歸**：貓臉特徵點(landmarks)共有9組(x, y)座標，故輸出層有18個神經元，最後階段不使用激勵函數而直接採用原始數值。透過視覺化將座標實際顯現在貓臉上，可直觀看出迴歸效果。迴歸模型透過R-square指標衡量，越接近1效果越好。
3. **貓狗頭部分類及方框迴歸**：資料集中每張圖定會有一隻貓或狗，須預測屬於哪一類別以及Bounding Box的位置，Bounding Box的表示非原始運用"左上角"及"下右腳"兩點的座標值，而是轉換成中心點的座標+長度與寬度，這種表示法對模型訓練更加有利。由於涉及"分類"及"定位"兩個任務，故有兩個不同的prediction head。分類head的輸出層有2個神經元分別表示"貓"及"狗"這兩個互斥類別(且最後經過softmax處理，使所有類別的預測值加總為1)，迴歸head的輸出層則有4個神經元預測中心點x、y座標值，以及寬度和高度。可透過IoU指標計算方框重疊程度，了解模型預測的好壞。
4. **車輛多標籤分類**：藉由俯視圖預測馬路上的車種(由於自訂模型未針對物件尺度做處理，故資料須留意為"空拍"視角而非有深近的"眺望"視角)，共4種車種。且每種均可能出現在圖中，故為多標籤(multi-label)的分類問題。因涉及多標籤，輸出層的激勵函數須為sigmoid而非softmax。衡量方式以為mAP為佳，mean表多個類別的AP取平均，但由於資料集不同類別的樣本數不一，且完全無車子的樣本極少難以輔助車子的判別(導致所有圖片幾乎預測有車)，資料集品質有待提升，也建議另採用樣本不平衡之對應手法。
